---
import { CollectionEntry, getCollection } from 'astro:content';
import LayoutSwitcher from '~/layouts/LayoutSwitcher.astro';
import { stripLangFromSlug, getLangFromSlug } from '~/util';

export async function getStaticPaths() {
	const allPages = await getCollection('docs');

	return allPages.map((page) => {
		const lang = getLangFromSlug(page.slug);
		const slug = stripLangFromSlug(page.slug);
		return { params: { lang, slug }, props: page };
	});
}

export type Props = CollectionEntry<'docs'>;
const { data, render } = Astro.props;
const { Content, headings } = await render();
---

<LayoutSwitcher {...{ data, headings }}><Content /></LayoutSwitcher>
